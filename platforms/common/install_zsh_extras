#!/bin/sh


# install zsh plugins 
# remember to update "plugins" items in .zshrc file
echo "" 
echo "installing plugins for zsh"
export ZSH=${HOME}/.oh-my-zsh
export ZSH_CUSTOM=${ZSH}/custom
echo "----------------------------------------------------"
echo "ZSH_CUSTOM: ${ZSH_CUSTOM}"
for plugin in zsh-autosuggestions zsh-syntax-highlighting zsh-completions
do
  if [ ! -d ${ZSH_CUSTOM}/plugins/${plugin} ]; then
    git clone git://github.com/zsh-users/${plugin} ${ZSH_CUSTOM}/plugins/${plugin}
  else
    cd ${ZSH_CUSTOM}/plugins/${plugin}
    git pull
  fi
done

echo "install powerline fonts-------------------------------"
FONTS_PATH=${MY_ENV_ROOT}/extras/fonts
if [ -d ${FONTS_PATH} ] ; then
  cd ${FONTS_PATH}
  git pull
else
  # clone
  git clone https://github.com/powerline/fonts.git --depth=1 ${FONTS_PATH}
  cd ${FONTS_PATH}
fi
# install
./install.sh
# clean-up a bit

cd ${MY_ENV_ROOT}/platforms/common
# sleep 2
# rm -rf ${FONTS_PATH}

SYSOS=`uname -s`
if [ ${SYSOS} = "Darwin" ] ; then
  echo "------------------------------------------------------"
  echo ""
  echo "iTerm2 users need to set both the Regular font and the Non-ASCII Font in 'iTerm > Preferences > Profiles > Text' to use a patched font "
  echo "Ref: https://github.com/powerline/fonts" 
  echo ""
  echo "------------------------------------------------------"
fi     #ifend

echo "install oh-my-zsh-powerline-theme status-------------------------------"
# echo "MY_ENV_ROOT: ${MY_ENV_ROOT}"
cd ${MY_ENV_ROOT}/extras
POWERLINE_THEME=${MY_ENV_ROOT}/extras/oh-my-zsh-powerline-theme 
echo "${POWERLINE_THEME}"
# install powerline theme
if [ ! -d ${POWERLINE_THEME} ]; then
  git clone git@github.com:jeremyFreeAgent/oh-my-zsh-powerline-theme.git ${POWERLINE_THEME}
  cd ${POWERLINE_THEME}
else
  cd ${POWERLINE_THEME}
  git pull
fi
. ./install_in_omz.sh

cd ${MY_ENV_ROOT}/platforms/common

# sleep for 2 seconds to avoid error "shell-init: error retrieving current directory" when rm powerline-theme directory
# sleep 2
# rm -rf ${POWERLINE_THEME}
