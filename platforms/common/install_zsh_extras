#!/bin/sh

echo ${SHELL: -3}
if [[ ${SHELL: -3} != "zsh" ]] ; then 
  read -p "If you want to install zsh_extras including oh_my_zsh, you shall switch to zsh(chsh -s \$(which zsh}), and re-login then run again. [Y/n]" yn
  #echo "If you want to install zsh_extras, you shall switch to zsh. Type command: \n chsh -s \$(which \${SHELL}). "
  if [[ $yn == [Yy] ]];then
    chsh -s $(which zsh)
    return 1 
  else
    return 0
  fi
fi

echo ${ZSH_CUSTOM}
if [[ ${ZSH_CUSTOM} == "" ]]; then
  echo "Install oh_my_zsh first please and run install_zsh_extras again."
  return 0
fi

# install zsh plugins 
# remember to update "plugins" items in .zshrc file
for plugin in zsh-autosuggestions zsh-syntax-highlighting zsh-completions
do
  if [ ! -d ${ZSH_CUSTOM}/plugins/${plugin} ]; then
    git clone git://github.com/zsh-users/${plugin} ${ZSH_CUSTOM}/plugins/${plugin}
  else
    cd ${ZSH_CUSTOM}/plugins/${plugin}
    git pull
  fi
done

cd ${MY_ENV_ROOT}/extras

# install powerline theme
if [ ! -d ${MY_ENV_ROOT}/extras/oh-my-zsh-powerline-theme ]; then
  git clone git@github.com:jeremyFreeAgent/oh-my-zsh-powerline-theme.git
  cd oh-my-zsh-powerline-theme
else
  cd oh-my-zsh-powerline-theme
  git pull
fi
# echo $(pwd)
# cp -f powerline.zsh-theme ${ZSH}/themes/
source ./install_in_omz.sh
cd ..

# sleep for 2 seconds to avoid error "shell-init: error retrieving current directory" when rm powerline-theme directory
# sleep 2

cd ${MY_ENV_ROOT}/platforms/common
